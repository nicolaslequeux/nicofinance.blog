

let selectedFile
let rowObject

document.getElementById("fileUpLoad").addEventListener("change", event => {
  selectedFile = event.target.files[0]
})

document.getElementById("upLoadExcel").addEventListener("click", () => {
  if (selectedFile) {
    let fileReader = new FileReader()

    fileReader.onload = event => {
      let data = event.target.result

      let workbook = XLSX.read(data, { type: "binary" })

      workbook.SheetNames.forEach(sheet => {
        rowObject = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[sheet])

        rowObject.forEach(year => {
          // get the value for each key
          Object.values(year).forEach(data => {
            // remove index[0] which holds the year
            if (data !== Object.values(year)[0]) {
              document
                .getElementById("jsonData")
                .insertAdjacentHTML(
                  "beforebegin",
                  '<p style="margin:0;padding:0;">' + data + "</p>"
                )
            }
          })
        })
      })
    }

    fileReader.readAsBinaryString(selectedFile)
  } else {
    alert("Please select a file to convert")
  }
})
